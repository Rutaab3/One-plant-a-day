<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plant Calendar - One Plant a Day</title>
  <link href="no-wifi/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="no-wifi/aos/dist/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="no-wifi/fontawesome/css/all.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/calendar.css">
  <link rel="icon" href="./images/favicon.ico" type="image/x-icon">
</head>

<body>
  <nav class="navbar navbar-expand-lg sticky-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">
        <i class="fas fa-seedling"></i>
        One Plant a Day
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">
              <i class="fas fa-home"></i> Home
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="today.html">
              <i class="fas fa-calendar-day"></i> Today's Plant
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="calendar.html">
              <i class="fas fa-calendar"></i> Calendar
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">
              <i class="fas fa-info-circle"></i> About Us
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="faq.html">
              <i class="fas fa-question-circle"></i> FAQ
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <section class="calendar-section" data-aos="fade-up">
    <div class="container">
      <h2 class="section-title">Plant Discovery Calendar</h2>
      
      <div class="calendar-container">
        <div class="calendar-header">
          <h2>Plant Calendar</h2>
          <p>Discover which plants were featured on any day</p>
          
          <div class="calendar-nav">
            <button onclick="changeMonth(-1)">
              <i class="fas fa-chevron-left"></i>
              Previous
            </button>
            <div class="current-month" id="current-month">
              January 2025
            </div>
            <button onclick="changeMonth(1)">
              Next
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        </div>

        <div class="calendar-grid">
          <table class="calendar-table">
            <!-- <thead>
              <tr>
                <th>Sun</th>
                <th>Mon</th>
                <th>Tue</th>
                <th>Wed</th>
                <th>Thu</th>
                <th>Fri</th>
                <th>Sat</th>
              </tr>
            </thead> -->
            <tbody id="calendar-body">
              <!-- Calendar days will be generated by JavaScript -->
            </tbody>
          </table>
        </div>

        <div class="calendar-legend">
          <div class="legend-title">Legend</div>
          <div class="legend-items">
            <div class="legend-item">
              <div class="legend-color today"></div>
              <span>Today</span>
            </div>
            <div class="legend-item">
              <div class="legend-color has-plant"></div>
              <span>Plant Featured</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Plant Preview Modal -->
  <div class="plant-preview m-4" id="plant-preview">
    <div class="preview-content">
      <button class="preview-close" onclick="closePreview()">
        <i class="fas fa-times"></i>
      </button>
      <div id="preview-body">
        <!-- Preview content will be loaded here -->
      </div>
    </div>
  </div>
  
 <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-lg-3 col-md-6 mb-4">
          <h5>One Plant a Day</h5>
          <p>Daily knowledge for a greener, calmer mind.</p>
          <p> &copy; 2025 One Plant a Day. All reserved rights.</p>
          <div class="social-icons"></div>
        </div>
      
        <div class="col-lg-3 col-md-6 mb-4">
          <h5>Tools/Technologies</h5>
          <ul class="list-unstyled">
            <p> <i class="fas fa-laptop"></i> HTML/CSS/JS</p>
            <p> <i class="fas fa-database"></i> Googlesheet API</p>
            <p> <i class="fas fa-book"></i> Bootstrap, AOS, GSAP</p>
          </ul>
        </div>

        <div class="col-lg-3 col-md-6 mb-4">
          <h5>Privacy & Philosophy</h5>
          <p> <i class="fas fa-seedling"></i> "No login. No ads. Just pure knowlegde for nature enthusiest."</p>
          <p> <i class="fas fa-earth"></i> "Made to inspire a connection with nature â€” one plant at a time."</p>
        </div>

         <div class="col-lg-3 col-md-6 mb-4">
          <h5>Contact Info</h5>
          <ul class="list-unstyled">
            <p> <i class="fas fa-envelope fa-sm"></i> Plant@info.com</p>
            <p> <i class="fas fa-phone fa-sm"></i> +321 12303848 62</p>
            <p> <i class="fab fa-whatsapp fa-lg" style="font-weight:800"></i> +321 12303848 62</p>
          </ul>
        </div>
      </div>
    </div>
  </footer>

  <!-- Fullscreen Image Viewer -->
  <div id="imgModal" class="img-modal">
    <span class="close" onclick="closeFullscreen()">&times;</span>
    <img class="img-modal-content" id="imgFull">
    <div id="imgCaption"></div>
  </div>

  <script src="no-wifi/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="no-wifi/aos/dist/aos.js"></script>
  <script>
    AOS.init();

    let currentMonth = new Date().getMonth();
    let currentYear = new Date().getFullYear();
    let plantsData = [];

    const monthNames = [
      "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];

    async function fetchPlantData() {
      const API_KEY = "AIzaSyC34fdiOJbuA0tCJE2sw6y0vb5hJtXlnH0";
      const SHEET_ID = "14bnDMkY2CWO-d21B0O08aZaTXetVwl--KoD4h4U2xmw";
      const SHEET_NAME = "Sheet1";

      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;

      try {
        const res = await fetch(url);
        const json = await res.json();
        const rows = json.values;
        if (!rows || rows.length <= 1) throw new Error("No data found.");

        const headers = rows[0];
        plantsData = rows.slice(1).map(row => {
          const obj = {};
          headers.forEach((h, i) => obj[h] = row[i] || "");
          return obj;
        });

        generateCalendar();
      } catch (error) {
        console.error("Error loading plant data:", error);
        generateCalendar();
      }
    }

   function generateCalendar() {
  const firstDay = new Date(currentYear, currentMonth, 1).getDay();
  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
  const today = new Date();
  
  document.getElementById("current-month").textContent = `${monthNames[currentMonth]} ${currentYear}`;
  
  let calendarHTML = "";
  let date = 1;

  for (let week = 0; week < 6; week++) {
    calendarHTML += "<tr>";
    
    for (let day = 0; day < 7; day++) {
      if (week === 0 && day < firstDay) {
        calendarHTML += "<td></td>";
      } else if (date > daysInMonth) {
        calendarHTML += "<td></td>";
      } else {
        const currentDate = new Date(currentYear, currentMonth, date);
        const isToday = currentDate.toDateString() === today.toDateString();
        const hasPlant = plantsData.length > 0;

        let classes = "calendar-day";
        if (isToday) classes += " today";
        if (hasPlant) classes += " has-plant";

        // Format with weekday + full date
        const options = { weekday: 'short', month: 'short', day: 'numeric', year: 'numeric' };
        const fullDate = currentDate.toLocaleDateString('en-US', options);

        calendarHTML += `
          <td>
            <button class="${classes}" onclick="showPlantPreview(${date})">
              <div class="day-number">${fullDate}</div>
              ${hasPlant ? '<div class="plant-indicator">Plant</div>' : ''}
            </button>
          </td>
        `;
        date++;
      }
    }
    
    calendarHTML += "</tr>";
    
    if (date > daysInMonth) break;
  }
  
  document.getElementById("calendar-body").innerHTML = calendarHTML;
}


    function changeMonth(direction) {
      currentMonth += direction;
      
      if (currentMonth > 11) {
        currentMonth = 0;
        currentYear++;
      } else if (currentMonth < 0) {
        currentMonth = 11;
        currentYear--;
      }
      
      generateCalendar();
    }

    function showPlantPreview(day) {
      if (plantsData.length === 0) return;
      
      const selectedDate = new Date(currentYear, currentMonth, day);
      const startOfYear = new Date(selectedDate.getFullYear(), 0, 0);
      const diff = selectedDate - startOfYear;
      const dayOfYear = Math.floor(diff / (1000 * 60 * 60 * 24));
      const plantIndex = dayOfYear % plantsData.length;
      const plant = plantsData[plantIndex];
      
      const optimizedURL = plant.image_url.includes("?") ? `${plant.image_url}&w=400` : `${plant.image_url}?w=400`;
      
      document.getElementById("preview-body").innerHTML = `
        <img src="${optimizedURL}" alt="${plant.plant_name}" class="preview-image" onclick="openFullscreen(this)">
        <h3 class="preview-title">${plant.plant_name}</h3>
        <p class="preview-date">${monthNames[currentMonth]} ${day}, ${currentYear}</p>
        <ul class="preview-facts">
          <li><i class="fas fa-leaf"></i> ${plant.fact_1}</li>
          <li><i class="fas fa-leaf"></i> ${plant.fact_2}</li>
          <li><i class="fas fa-leaf"></i> ${plant.fact_3}</li>
        </ul>
      `;
      
      document.getElementById("plant-preview").classList.add("active");
    }

    function closePreview() {
      document.getElementById("plant-preview").classList.remove("active");
    }

    document.getElementById("plant-preview").addEventListener("click", function(e) {
      if (e.target === this) {
        closePreview();
      }
    });

    fetchPlantData();

    function openFullscreen(imgElement) {
      const modal = document.getElementById("imgModal");
      const modalImg = document.getElementById("imgFull");
      const caption = document.getElementById("imgCaption");
      
      modal.style.display = "block";
      modalImg.src = imgElement.src;
      caption.innerHTML = imgElement.alt;

      document.addEventListener("keydown", escClose);
    }

    function closeFullscreen() {
      document.getElementById("imgModal").style.display = "none";
      document.removeEventListener("keydown", escClose);
    }

    function escClose(event) {
      if (event.key === "Escape") {
        closeFullscreen();
      }
    }

    document.getElementById("imgModal").addEventListener("click", function(e) {
      if (e.target === this) {
        closeFullscreen();
      }
    });
  </script>
  
</body>
</html>
